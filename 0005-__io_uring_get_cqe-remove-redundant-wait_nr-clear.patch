From de4266dcee4c91b16a19def067a16207c466e2ea Mon Sep 17 00:00:00 2001
From: Jens Axboe <axboe@kernel.dk>
Date: Wed, 4 Mar 2020 06:55:31 -0700
Subject: [PATCH] __io_uring_get_cqe: remove redundant wait_nr clear

Fixes: dc14e30a0860 ("__io_uring_get_cqe: fix spurious -EAGAIN")
Reported-by: Xiaoguang Wang <xiaoguang.wang@linux.alibaba.com>
Signed-off-by: Jens Axboe <axboe@kernel.dk>
---
 src/queue.c | 2 --
 1 file changed, 2 deletions(-)

diff --git a/src/queue.c b/src/queue.c
index de2d002..1288484 100644
--- a/src/queue.c
+++ b/src/queue.c
@@ -55,8 +55,6 @@ int __io_uring_get_cqe(struct io_uring *ring, struct io_uring_cqe **cqe_ptr,
 		if (wait_nr || submit)
 			ret = __sys_io_uring_enter(ring->ring_fd, submit,
 						   wait_nr, flags, sigmask);
-		if (wait_nr)
-			wait_nr = 0;
 		if (ret < 0) {
 			err = -errno;
 		} else if (ret == submit) {
-- 
1.8.3.1

